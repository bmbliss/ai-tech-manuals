<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <div class="bg-white shadow sm:rounded-lg">
    <div class="px-4 py-5 sm:p-6">
      <div class="space-y-4">
        <div class="flex items-center justify-between">
          <div>
            <%= link_to manual_section_revisions_path(@manual, @section), 
                class: "inline-flex items-center text-gray-500 hover:text-gray-700 mb-4" do %>
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
              </svg>
              Back to Revision History
            <% end %>
            <h3 class="text-lg font-medium text-gray-900">
              Revision by <%= @revision.created_by.email %>
            </h3>
            <p class="mt-1 text-sm text-gray-500">
              Created <%= time_ago_in_words(@revision.created_at) %> ago
            </p>
          </div>
          <div class="flex items-center gap-4">
            <% case @revision.status %>
            <% when 'pending' %>
              <%= button_to "Approve", approve_manual_section_revision_path(@manual, @section, @revision), 
                  method: :post,
                  class: "px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700" %>
              <%= button_to "Reject", reject_manual_section_revision_path(@manual, @section, @revision), 
                  method: :post,
                  class: "px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700" %>
            <% when 'approved' %>
              <div class="flex items-center text-green-700 bg-green-50 px-4 py-2 rounded-md">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                <span class="text-sm font-medium">Approved</span>
              </div>
            <% when 'rejected' %>
              <div class="flex items-center text-red-700 bg-red-50 px-4 py-2 rounded-md">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
                <span class="text-sm font-medium">Rejected</span>
              </div>
            <% end %>
          </div>
        </div>

        <div class="prose max-w-none">
          <h4>Change Description:</h4>
          <p><%= @revision.change_description %></p>
        </div>

        <div class="space-y-6">
          <div class="border rounded-md p-4">
            <h4 class="text-sm font-medium text-gray-700 mb-2">Proposed Changes:</h4>
            <div class="diff-view">
              <%= @diff.html_safe %>
            </div>
          </div>
        </div>

        <style>
          .diff-view ins {
            background-color: #d1fae5;
            text-decoration: none;
            color: #065f46;
          }
          
          .diff-view del {
            background-color: #fee2e2;
            text-decoration: line-through;
            color: #991b1b;
          }
        </style>

        <%= render "comments", revision: @revision %>
      </div>
    </div>
  </div>
</div> 